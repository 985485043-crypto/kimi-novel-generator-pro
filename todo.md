# Kimi 15000字小说生成器 - 项目 TODO

## 后端开发
- [x] 设计数据库模型（小说生成记录表）
- [x] 实现 Moonshot API 调用封装
- [x] 实现大纲生成 API 端点
- [x] 实现分段生成 API 端点（支持流式响应）
- [x] 实现进度查询 API 端点
- [x] 编写后端单元测试

## 前端开发
- [x] 设计简洁直观的单页应用界面
- [x] 实现 API Key 输入框（安全存储）
- [x] 实现小说标题输入框
- [x] 实现"开始生成"按钮和加载动画
- [x] 实现实时进度显示（当前字数/目标字数）
- [x] 实现生成内容的实时显示区域
- [x] 实现文件下载功能（.txt 格式）
- [x] 实现错误提示和状态管理

## 核心功能集成
- [x] 集成 Moonshot AI 长文本生成逻辑
- [x] 实现分段生成与上下文管理
- [x] 实现进度跟踪和实时更新
- [x] 测试长文本生成的连贫性
## 测试与优化
- [x] 功能测试（端到端测试）
- [ ] 性能测试（长文本生成速度）
- [ ] 错误处理测试
- [ ] 跨浏览器兼容性测试

## 部署
- [x] 部署到 Manus 平台
- [x] 验证生产环境功能
- [x] 生成可访问的链接

## 问题修复
- [x] 修复 401 Invalid Authentication 错误
- [x] 改进 API 错误处理和用户提示
- [x] 验证 Moonshot API 配置
- [x] 测试 API Key 验证流程
- [x] 修复 API 端点（https://api.moonshot.cn/v1）
- [x] 修复模型名称（kimi-k2-turbo-preview）
- [x] 更新单元测试

## 新功能：历史记录和创作类型
- [x] 扩展数据库模型，添加小说类型字段
- [x] 创建小说历史记录表
- [x] 实现后端 API：保存小说记录
- [x] 实现后端 API：获取历史记录列表
- [x] 实现后端 API：删除历史记录
- [x] 前端：添加创作类型选择器（都市言情、虫恋、家庭、悬疑、甲嬇）
- [x] 前端：添加历史记录面板
- [x] 前端：实现历史记录的查看、下载、删除功能
- [x] 优化 AI 提示词，确保不同类型生成不同风格的内容
- [x] 编写单元测试（所有 14 个测试通过）
- [x] 测试整个流程


## Bug 修复
- [x] 修复 segmentIndex 验证错误（必须 ≥ 0）
- [x] 改进前端段落生成逻辑（使用 segmentCount 代替 currentIdx）
- [x] 完善错误处理和提示
